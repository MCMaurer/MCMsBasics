y0 = coords$ymin,
y1 = coords$lower,
gp = gpar(lwd = coords$size))
upper <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$upper,
y1 = coords$ymax,
gp = gpar(lwd = coords$size))
gTree(children = gList(median, lower, upper))
}
GeomTufteBox <- ggproto("GeomTufteBox", Geom,
required_aes = c("x", "ymin", "lower", "median", "upper", "ymax"),
default_aes = aes(shape = 19, size = 2),
draw_key = draw_key_point,
draw_panel = draw_panel_function)
geom_tuftebox <- function(mapping = NULL, data = NULL, stat = "TufteBox",
position = "identity", show.legend = NA,
na.rm = FALSE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = stat,
data = data,
mapping = mapping,
geom = GeomTufteBox,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(na.rm = na.rm, ...)
)
}
mtcars %>%
mutate(cyl = factor(cyl)) %>%
ggplot(aes(x = cyl, y = mpg)) +
geom_tuftebox() +
MCMsBasics::minimal_ggplot_theme()
library(tidyr)
library(dplyr)
library(ggplot2)
library(grid)
StatTufteBox <- ggproto("StatTufteBox", Stat,
compute_group = function(data, scales) {
probs <- c(0, 0.25, 0.5, 0.75, 1)
qq <- quantile(data$y, probs = probs, na.rm = T)
out <- qq %>% as.list() %>% as.data.frame()
names(out) <- c("ymin", "lower", "median",
"upper", "ymax")
out$x <- data$x[1]
out
},
required_aes = c("x", "y")
)
stat_tuftebox <- function(mapping = NULL, data = NULL, geom = "TufteBox",
position = "identity", show.legend = NA,
outliers = TRUE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = StatTufteBox,
data = data,
mapping = mapping,
geom = geom,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(outliers = outliers, ...)
)
}
library(scales)
draw_panel_function <- function(data, panel_scales, coord){
coords <- coord$transform(data, panel_scales) %>%
mutate(lower = rescale(lower, from = panel_scales$y.range),
upper = rescale(upper, from = panel_scales$y.range),
median = rescale(median, from = panel_scales$y.range))
str(coords)
median <- pointsGrob(x = coords$x,
y = coords$median,
pch = coords$shape,
size = unit(coords$size*3, "pt"))
lower <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$ymin,
y1 = coords$lower,
gp = gpar(lwd = coords$size))
upper <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$upper,
y1 = coords$ymax,
gp = gpar(lwd = coords$size))
gTree(children = gList(median, lower, upper))
str(gTree(children = gList(median, lower, upper)))
}
GeomTufteBox <- ggproto("GeomTufteBox", Geom,
required_aes = c("x", "ymin", "lower", "median", "upper", "ymax"),
default_aes = aes(shape = 19, size = 2),
draw_key = draw_key_point,
draw_panel = draw_panel_function)
geom_tuftebox <- function(mapping = NULL, data = NULL, stat = "TufteBox",
position = "identity", show.legend = NA,
na.rm = FALSE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = stat,
data = data,
mapping = mapping,
geom = GeomTufteBox,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(na.rm = na.rm, ...)
)
}
mtcars %>%
mutate(cyl = factor(cyl)) %>%
ggplot(aes(x = cyl, y = mpg)) +
geom_tuftebox() +
MCMsBasics::minimal_ggplot_theme()
library(tidyr)
library(dplyr)
library(ggplot2)
library(grid)
StatTufteBox <- ggproto("StatTufteBox", Stat,
compute_group = function(data, scales) {
probs <- c(0, 0.25, 0.5, 0.75, 1)
qq <- quantile(data$y, probs = probs, na.rm = T)
out <- qq %>% as.list() %>% as.data.frame()
names(out) <- c("ymin", "lower", "median",
"upper", "ymax")
out$x <- data$x[1]
out
},
required_aes = c("x", "y")
)
stat_tuftebox <- function(mapping = NULL, data = NULL, geom = "TufteBox",
position = "identity", show.legend = NA,
outliers = TRUE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = StatTufteBox,
data = data,
mapping = mapping,
geom = geom,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(outliers = outliers, ...)
)
}
library(scales)
draw_panel_function <- function(data, panel_scales, coord){
coords <- coord$transform(data, panel_scales) %>%
mutate(lower = rescale(lower, from = panel_scales$y.range),
upper = rescale(upper, from = panel_scales$y.range),
median = rescale(median, from = panel_scales$y.range))
str(coords)
median <- pointsGrob(x = coords$x,
y = coords$median,
pch = coords$shape,
size = unit(coords$size*3, "pt"))
lower <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$ymin,
y1 = coords$lower,
gp = gpar(lwd = coords$size))
upper <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$upper,
y1 = coords$ymax,
gp = gpar(lwd = coords$size))
str(upper)
gTree(children = gList(median, lower, upper))
str(gTree(children = gList(median, lower, upper)))
}
GeomTufteBox <- ggproto("GeomTufteBox", Geom,
required_aes = c("x", "ymin", "lower", "median", "upper", "ymax"),
default_aes = aes(shape = 19, size = 2),
draw_key = draw_key_point,
draw_panel = draw_panel_function)
geom_tuftebox <- function(mapping = NULL, data = NULL, stat = "TufteBox",
position = "identity", show.legend = NA,
na.rm = FALSE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = stat,
data = data,
mapping = mapping,
geom = GeomTufteBox,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(na.rm = na.rm, ...)
)
}
mtcars %>%
mutate(cyl = factor(cyl)) %>%
ggplot(aes(x = cyl, y = mpg)) +
geom_tuftebox() +
MCMsBasics::minimal_ggplot_theme()
library(tidyr)
library(dplyr)
library(ggplot2)
library(grid)
StatTufteBox <- ggproto("StatTufteBox", Stat,
compute_group = function(data, scales) {
probs <- c(0, 0.25, 0.5, 0.75, 1)
qq <- quantile(data$y, probs = probs, na.rm = T)
out <- qq %>% as.list() %>% as.data.frame()
names(out) <- c("ymin", "lower", "median",
"upper", "ymax")
out$x <- data$x[1]
out
},
required_aes = c("x", "y")
)
stat_tuftebox <- function(mapping = NULL, data = NULL, geom = "TufteBox",
position = "identity", show.legend = NA,
outliers = TRUE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = StatTufteBox,
data = data,
mapping = mapping,
geom = geom,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(outliers = outliers, ...)
)
}
library(scales)
draw_panel_function <- function(data, panel_scales, coord){
coords <- coord$transform(data, panel_scales) %>%
mutate(lower = rescale(lower, from = panel_scales$y.range),
upper = rescale(upper, from = panel_scales$y.range),
median = rescale(median, from = panel_scales$y.range))
median <- pointsGrob(x = coords$x,
y = coords$median,
pch = coords$shape,
size = unit(coords$size*3, "pt"))
lower <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$ymin,
y1 = coords$lower,
gp = gpar(lwd = coords$size))
upper <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$upper,
y1 = coords$ymax,
gp = gpar(lwd = coords$size))
gTree(children = gList(median, lower, upper))
}
GeomTufteBox <- ggproto("GeomTufteBox", Geom,
required_aes = c("x", "ymin", "lower", "median", "upper", "ymax"),
default_aes = aes(shape = 19, size = 2),
draw_key = draw_key_point,
draw_panel = draw_panel_function)
geom_tuftebox <- function(mapping = NULL, data = NULL, stat = "TufteBox",
position = "identity", show.legend = NA,
na.rm = FALSE, inherit.aes = TRUE, ...){
str(ggplot2::layer(
stat = stat,
data = data,
mapping = mapping,
geom = GeomTufteBox,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(na.rm = na.rm, ...)
))
ggplot2::layer(
stat = stat,
data = data,
mapping = mapping,
geom = GeomTufteBox,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(na.rm = na.rm, ...)
)
}
mtcars %>%
mutate(cyl = factor(cyl)) %>%
ggplot(aes(x = cyl, y = mpg)) +
geom_tuftebox() +
MCMsBasics::minimal_ggplot_theme()
library(tidyr)
library(dplyr)
library(ggplot2)
library(grid)
StatTufteBox <- ggproto("StatTufteBox", Stat,
compute_group = function(data, scales) {
probs <- c(0, 0.25, 0.5, 0.75, 1)
qq <- quantile(data$y, probs = probs, na.rm = T)
out <- qq %>% as.list() %>% as.data.frame()
names(out) <- c("ymin", "lower", "median",
"upper", "ymax")
out$x <- data$x[1]
out
print(scales)
},
required_aes = c("x", "y")
)
stat_tuftebox <- function(mapping = NULL, data = NULL, geom = "TufteBox",
position = "identity", show.legend = NA,
outliers = TRUE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = StatTufteBox,
data = data,
mapping = mapping,
geom = geom,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(outliers = outliers, ...)
)
}
library(scales)
draw_panel_function <- function(data, panel_scales, coord){
coords <- coord$transform(data, panel_scales) %>%
mutate(lower = rescale(lower, from = panel_scales$y.range),
upper = rescale(upper, from = panel_scales$y.range),
median = rescale(median, from = panel_scales$y.range))
median <- pointsGrob(x = coords$x,
y = coords$median,
pch = coords$shape,
size = unit(coords$size*3, "pt"))
lower <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$ymin,
y1 = coords$lower,
gp = gpar(lwd = coords$size))
upper <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$upper,
y1 = coords$ymax,
gp = gpar(lwd = coords$size))
gTree(children = gList(median, lower, upper))
}
GeomTufteBox <- ggproto("GeomTufteBox", Geom,
required_aes = c("x", "ymin", "lower", "median", "upper", "ymax"),
default_aes = aes(shape = 19, size = 2),
draw_key = draw_key_point,
draw_panel = draw_panel_function)
geom_tuftebox <- function(mapping = NULL, data = NULL, stat = "TufteBox",
position = "identity", show.legend = NA,
na.rm = FALSE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = stat,
data = data,
mapping = mapping,
geom = GeomTufteBox,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(na.rm = na.rm, ...)
)
}
mtcars %>%
mutate(cyl = factor(cyl)) %>%
ggplot(aes(x = cyl, y = mpg)) +
geom_tuftebox() +
MCMsBasics::minimal_ggplot_theme()
library(tidyr)
library(dplyr)
library(ggplot2)
library(grid)
StatTufteBox <- ggproto("StatTufteBox", Stat,
compute_group = function(data, scales) {
probs <- c(0, 0.25, 0.5, 0.75, 1)
qq <- quantile(data$y, probs = probs, na.rm = T)
out <- qq %>% as.list() %>% as.data.frame()
names(out) <- c("ymin", "lower", "median",
"upper", "ymax")
out$x <- data$x[1]
out
},
required_aes = c("x", "y")
)
stat_tuftebox <- function(mapping = NULL, data = NULL, geom = "TufteBox",
position = "identity", show.legend = NA,
outliers = TRUE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = StatTufteBox,
data = data,
mapping = mapping,
geom = geom,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(outliers = outliers, ...)
)
}
library(scales)
draw_panel_function <- function(data, panel_scales, coord){
coords <- coord$transform(data, panel_scales) %>%
mutate(lower = rescale(lower, from = panel_scales$y.range),
upper = rescale(upper, from = panel_scales$y.range),
median = rescale(median, from = panel_scales$y.range))
median <- pointsGrob(x = coords$x,
y = coords$median,
pch = coords$shape,
size = unit(coords$size*3, "pt"))
lower <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$ymin,
y1 = coords$lower,
gp = gpar(lwd = coords$size))
upper <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$upper,
y1 = coords$ymax,
gp = gpar(lwd = coords$size))
gTree(children = gList(median, lower, upper))
}
GeomTufteBox <- ggproto("GeomTufteBox", Geom,
required_aes = c("x", "ymin", "lower", "median", "upper", "ymax"),
default_aes = aes(shape = 19, size = 2),
draw_key = draw_key_point,
draw_panel = draw_panel_function)
geom_tuftebox <- function(mapping = NULL, data = NULL, stat = "TufteBox",
position = "identity", show.legend = NA,
na.rm = FALSE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = stat,
data = data,
mapping = mapping,
geom = GeomTufteBox,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(na.rm = na.rm, ...)
)
}
mtcars %>%
mutate(cyl = factor(cyl)) %>%
ggplot(aes(x = cyl, y = mpg)) +
geom_tuftebox() +
MCMsBasics::minimal_ggplot_theme()
library(tidyr)
library(dplyr)
library(ggplot2)
library(grid)
StatTufteBox <- ggproto("StatTufteBox", Stat,
compute_group = function(data, scales) {
probs <- c(0, 0.25, 0.5, 0.75, 1)
qq <- quantile(data$y, probs = probs, na.rm = T)
out <- qq %>% as.list() %>% as.data.frame()
names(out) <- c("ymin", "lower", "median",
"upper", "ymax")
out$x <- data$x[1]
out
},
required_aes = c("x", "y")
)
stat_tuftebox <- function(mapping = NULL, data = NULL, geom = "TufteBox",
position = "identity", show.legend = NA,
outliers = TRUE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = StatTufteBox,
data = data,
mapping = mapping,
geom = geom,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(outliers = outliers, ...)
)
}
library(scales)
draw_panel_function <- function(data, panel_scales, coord){
coords <- coord$transform(data, panel_scales) %>%
mutate(lower = rescale(lower, from = panel_scales$y.range),
upper = rescale(upper, from = panel_scales$y.range),
median = rescale(median, from = panel_scales$y.range))
median <- pointsGrob(x = coords$x,
y = coords$median,
pch = coords$shape,
size = unit(coords$size*3, "pt"))
lower <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$ymin,
y1 = coords$lower,
gp = gpar(lwd = coords$size))
upper <- segmentsGrob(x0 = coords$x,
x1 = coords$x,
y0 = coords$upper,
y1 = coords$ymax,
gp = gpar(lwd = coords$size))
gTree(children = gList(median, lower, upper))
}
GeomTufteBox <- ggproto("GeomTufteBox", Geom,
required_aes = c("x", "ymin", "lower", "median", "upper", "ymax"),
default_aes = aes(shape = 19, size = 2),
draw_key = draw_key_point,
draw_panel = draw_panel_function)
geom_tuftebox <- function(mapping = NULL, data = NULL, stat = "TufteBox",
position = "identity", show.legend = NA,
na.rm = FALSE, inherit.aes = TRUE, ...){
ggplot2::layer(
stat = stat,
data = data,
mapping = mapping,
geom = GeomTufteBox,
position = position,
show.legend = show.legend,
inherit.aes = inherit.aes,
params = list(na.rm = na.rm, ...)
)
}
mtcars %>%
mutate(cyl = factor(cyl)) %>%
ggplot(aes(x = cyl, y = mpg)) +
geom_tuftebox() +
MCMsBasics::minimal_ggplot_theme()
ggsave("~/Downloads/tufte_boxplot.jpg")
mtcars %>%
mutate(cyl = factor(cyl)) %>%
ggplot(aes(x = cyl, y = mpg)) +
geom_tuftebox() +
MCMsBasics::minimal_ggplot_theme()
